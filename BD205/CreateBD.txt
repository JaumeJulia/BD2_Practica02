CREATE DATABASE BD205;

USE BD205;

CREATE TABLE CATEGORIA (categoria CHAR(30) NOT NULL PRIMARY KEY);

CREATE TABLE TIPUS_CONTRACTE (tipusContracte CHAR(10) NOT NULL PRIMARY KEY);

CREATE TABLE TIPUS_USUARI (tipusUsuari CHAR(30) NOT NULL PRIMARY KEY);

CREATE TABLE USUARI (nomUsuari CHAR(30) NOT NULL PRIMARY KEY, tipusUsuari CHAR(30) NOT NULL, contrasenya CHAR(30) NOT NULL, nomiLlinatges CHAR(50) NOT NULL, admin BOOLEAN NOT NULL, FOREIGN KEY (tipusUsuari) REFERENCES tipus_usuari(tipusUsuari));

CREATE TABLE CONTRACTE (idContracte INT(9) NOT NULL PRIMARY KEY, nomUsuari CHAR(30) NOT NULL, tipusContracte CHAR(10) NOT NULL, dataAlta DATETIME NOT NULL, suscrit BOOLEAN NOT NULL, FOREIGN KEY (nomUsuari) REFERENCES usuari (nomUsuari), FOREIGN KEY (tipusContracte) REFERENCES tipus_contracte (tipusContracte));

CREATE TABLE FACTURA (idFactura INT(9) NOT NULL PRIMARY KEY, idContracte INT(9) NOT NULL, data DATETIME NOT NULL, import INT(2) NOT NULL, FOREIGN KEY (idContracte) REFERENCES contracte (idContracte));

CREATE TABLE CONTINGUT (idContingut INT(9) NOT NULL PRIMARY KEY, categoria CHAR(30) NOT NULL, titol CHAR(30) NOT NULL, video CHAR(50) NOT NULL, FOREIGN KEY (categoria) REFERENCES categoria (categoria));

CREATE TABLE MISSATGE (idMissatge CHAR(9) NOT NULL PRIMARY KEY, nomUsuari CHAR(30) NOT NULL, idContingut INT(9) NOT NULL, missatge CHAR(100) NOT NULL, vist BOOLEAN NOT NULL, FOREIGN KEY (nomUsuari) REFERENCES usuari (nomUsuari), FOREIGN KEY (idContingut) REFERENCES contingut (idContingut));

CREATE TABLE CONTFAV(idFavoritCont CHAR(9) NOT NULL PRIMARY KEY, idContracte INT(9) NOT NULL, idContingut INT(9) NOT NULL, FOREIGN KEY (idContracte) REFERENCES contracte (idContracte), FOREIGN KEY (idContingut) REFERENCES contingut (idContingut));

CREATE TABLE CATFAV(idFavoritCat CHAR(9) NOT NULL PRIMARY KEY, idContracte INT(9) NOT NULL, categoria CHAR(30) NOT NULL, FOREIGN KEY (idContracte) REFERENCES contracte (idContracte), FOREIGN KEY (categoria) REFERENCES categoria (categoria));

CREATE TABLE RECOMANAT (tipusUsuari CHAR(30) NOT NULL, idContingut INT(9) NOT NULL, PRIMARY KEY (tipusUsuari,idContingut), FOREIGN KEY (tipusUsuari) REFERENCES tipus_usuari (tipusUsuari), FOREIGN KEY (idContingut) REFERENCES contingut (idContingut));